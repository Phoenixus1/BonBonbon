<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Gestion Pro - Victor & Arthur (Supabase)</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">

<style>
/* ============ VARIABLES ============ */
:root {
  --bg: #f8fafc;
  --card: #ffffff;
  --text: #0f172a;
  --text-light: #64748b;
  --accent: #2563eb;
  --victor-color: #2563eb;
  --arthur-color: #10b981;
  --border: #e2e8f0;
  --hover: #f1f5f9;
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
  --sidebar-bg: #ffffff;
  --shadow: 0 10px 25px -5px rgba(0,0,0,0.05);
  --radius: 16px;
}

body.dark {
  --bg: #0f172a;
  --card: #1e293b;
  --text: #f1f5f9;
  --text-light: #94a3b8;
  --accent: #38bdf8;
  --victor-color: #3b82f6;
  --arthur-color: #10b981;
  --border: #334155;
  --hover: #2d3a4f;
  --sidebar-bg: #1e293b;
  --shadow: 0 10px 25px -5px rgba(0,0,0,0.2);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Inter', 'Segoe UI', Roboto, sans-serif;
  transition: background-color 0.2s, color 0.2s, border-color 0.2s, transform 0.2s;
}

body {
  background: var(--bg);
  color: var(--text);
  line-height: 1.5;
  overflow-x: hidden;
}

.app {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* ============ TOP BAR ============ */
.top-bar {
  background: var(--card);
  padding: 16px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  z-index: 20;
  box-shadow: var(--shadow);
}

.top-bar-left {
  display: flex;
  align-items: center;
  gap: 16px;
}

.menu-btn {
  background: transparent;
  color: var(--text);
  font-size: 22px;
  padding: 10px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.menu-btn:hover {
  background: var(--hover);
  transform: scale(1.05);
}

.logo {
  display: flex;
  align-items: center;
  gap: 10px;
}

.logo i {
  font-size: 24px;
  color: var(--accent);
}

.logo h1 {
  font-size: 18px;
  font-weight: 600;
  margin: 0;
}

.page-title {
  font-size: 20px;
  font-weight: 600;
  color: var(--text);
  margin-left: 8px;
}

.theme-btn {
  background: var(--bg);
  color: var(--text);
  border: 1px solid var(--border);
  width: 42px;
  height: 42px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
}

.theme-btn:hover {
  background: var(--hover);
  transform: rotate(15deg);
}

.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(3px);
  z-index: 98;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s;
}

.overlay.active {
  opacity: 1;
  visibility: visible;
}

.sidebar {
  position: fixed;
  top: 0;
  left: -300px;
  width: 280px;
  height: 100vh;
  background: var(--sidebar-bg);
  border-right: 1px solid var(--border);
  z-index: 99;
  transition: left 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  display: flex;
  flex-direction: column;
  box-shadow: 5px 0 20px rgba(0,0,0,0.05);
  overflow-y: auto;
}

.sidebar.open {
  left: 0;
}

.sidebar-header {
  padding: 24px 20px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 12px;
}

.sidebar-header i {
  font-size: 28px;
  color: var(--accent);
}

.sidebar-header h2 {
  font-size: 20px;
  font-weight: 600;
  margin: 0;
}

.sidebar-menu {
  flex: 1;
  padding: 20px 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.sidebar-item {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 14px 16px;
  border-radius: 12px;
  color: var(--text);
  text-decoration: none;
  transition: all 0.2s;
  cursor: pointer;
  font-weight: 500;
}

.sidebar-item i {
  width: 22px;
  text-align: center;
  font-size: 18px;
  color: var(--text-light);
  transition: all 0.2s;
}

.sidebar-item span {
  flex: 1;
}

.sidebar-item:hover {
  background: var(--hover);
}

.sidebar-item:hover i {
  color: var(--accent);
}

.sidebar-item.active {
  background: var(--accent);
  color: white;
}

.sidebar-item.active i {
  color: white;
}

.sidebar-footer {
  padding: 20px 12px;
  border-top: 1px solid var(--border);
  margin-top: auto;
}

.main-content {
  flex: 1;
  padding: 20px;
  max-width: 1400px;
  margin: 0 auto;
  width: 100%;
}

.tab-content {
  display: none;
  animation: fadeIn 0.3s;
}

.tab-content.active {
  display: block;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.card {
  background: var(--card);
  border-radius: var(--radius);
  padding: 20px;
  margin-bottom: 20px;
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
}

.card-title {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
  color: var(--text);
}

.card-title i {
  color: var(--accent);
}

.grid-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}

.grid-3 {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
}

.grid-4 {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 16px;
}

input, select, textarea {
  padding: 14px 16px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: var(--bg);
  color: var(--text);
  font-size: 15px;
  width: 100%;
  transition: all 0.2s;
}

input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(37,99,235,0.1);
}

.btn {
  padding: 14px 20px;
  border-radius: 12px;
  border: none;
  font-weight: 600;
  font-size: 15px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  transition: all 0.2s;
  background: var(--accent);
  color: white;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 16px rgba(37,99,235,0.2);
}

.btn-sm {
  padding: 10px 16px;
  font-size: 14px;
}

.btn-block {
  width: 100%;
}

.badge {
  padding: 6px 12px;
  border-radius: 30px;
  font-size: 12px;
  font-weight: 600;
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.badge-success {
  background: rgba(16,185,129,0.15);
  color: #10b981;
}

.badge-warning {
  background: rgba(245,158,11,0.15);
  color: #f59e0b;
}

.badge-danger {
  background: rgba(239,68,68,0.15);
  color: #ef4444;
}

.badge-info {
  background: rgba(37,99,235,0.15);
  color: #2563eb;
}

.stat-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

.stat-icon {
  width: 48px;
  height: 48px;
  border-radius: 16px;
  background: rgba(37,99,235,0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 12px;
}

.stat-icon i {
  font-size: 24px;
  color: var(--accent);
}

.stat-number {
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 4px;
}

.stat-label {
  font-size: 14px;
  color: var(--text-light);
}

.table-responsive {
  overflow-x: auto;
  margin-top: 16px;
  border-radius: 12px;
}

table {
  width: 100%;
  border-collapse: collapse;
}

th {
  text-align: left;
  padding: 16px;
  background: var(--bg);
  font-weight: 600;
  color: var(--text);
  border-bottom: 2px solid var(--border);
}

td {
  padding: 16px;
  border-bottom: 1px solid var(--border);
}

tr:hover td {
  background: var(--hover);
}

.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 20px;
}

.product-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 20px;
  transition: all 0.2s;
}

.product-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow);
}

.stock-bar {
  width: 100%;
  height: 8px;
  background: var(--border);
  border-radius: 4px;
  margin: 16px 0;
  overflow: hidden;
}

.stock-fill {
  height: 100%;
  background: var(--accent);
  border-radius: 4px;
  transition: width 0.3s;
}

.calendar-header {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 8px;
  margin-bottom: 8px;
  padding: 0 4px;
}

.calendar-weekday {
  text-align: center;
  font-weight: 600;
  color: var(--text-light);
  font-size: 14px;
  padding: 8px;
}

.calendar-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 8px;
}

.calendar-day {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 12px 8px;
  min-height: 100px;
}

.calendar-day-number {
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--accent);
}

.calendar-event {
  background: rgba(37,99,235,0.1);
  color: var(--accent);
  padding: 6px 8px;
  border-radius: 6px;
  font-size: 11px;
  margin-top: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.clients-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
}

.client-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 20px;
}

@media (max-width: 1024px) {
  .grid-2 {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 768px) {
  .main-content {
    padding: 16px;
  }
  
  .logo h1 {
    display: none;
  }
  
  .page-title {
    font-size: 18px;
  }
  
  .grid-4 {
    grid-template-columns: 1fr 1fr;
  }
  
  .calendar-grid {
    grid-template-columns: repeat(1, 1fr);
  }
  
  .calendar-header {
    display: none;
  }
}

@media (max-width: 480px) {
  .grid-4 {
    grid-template-columns: 1fr;
  }
  
  .product-grid {
    grid-template-columns: 1fr;
  }
  
  .clients-grid {
    grid-template-columns: 1fr;
  }
  
  .btn {
    width: 100%;
  }
}

.mb-2 { margin-bottom: 16px; }
.mb-3 { margin-bottom: 24px; }
.mt-2 { margin-top: 16px; }
.text-center { text-align: center; }
.w-100 { width: 100%; }
</style>
</head>

<body>
<div class="app">
  <div class="overlay" id="overlay" onclick="closeMenu()"></div>

  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <i class="fas fa-chart-line"></i>
      <h2>Gestion Pro</h2>
    </div>
    
    <div class="sidebar-menu">
      <div class="sidebar-item active" onclick="switchTab('dashboard'); closeMenu()">
        <i class="fas fa-home"></i>
        <span>Tableau de bord</span>
      </div>
      <div class="sidebar-item" onclick="switchTab('products'); closeMenu()">
        <i class="fas fa-box"></i>
        <span>Produits</span>
      </div>
      <div class="sidebar-item" onclick="switchTab('inventory'); closeMenu()">
        <i class="fas fa-warehouse"></i>
        <span>Stocks</span>
      </div>
      <div class="sidebar-item" onclick="switchTab('sheets'); closeMenu()">
        <i class="fas fa-file-alt"></i>
        <span>Fiches produits</span>
      </div>
      <div class="sidebar-item" onclick="switchTab('calendar'); closeMenu()">
        <i class="fas fa-calendar"></i>
        <span>Calendrier</span>
      </div>
      <div class="sidebar-item" onclick="switchTab('stats'); closeMenu()">
        <i class="fas fa-chart-pie"></i>
        <span>Statistiques</span>
      </div>
      <div class="sidebar-item" onclick="switchTab('clients'); closeMenu()">
        <i class="fas fa-users"></i>
        <span>Clients</span>
      </div>
    </div>
    
    <div class="sidebar-footer">
      <div class="sidebar-item" onclick="toggleDark(); closeMenu()">
        <i class="fas fa-moon"></i>
        <span>Mode sombre</span>
      </div>
    </div>
  </div>

  <div class="top-bar">
    <div class="top-bar-left">
      <button class="menu-btn" onclick="toggleMenu()">
        <i class="fas fa-bars"></i>
      </button>
      <div class="logo">
        <i class="fas fa-chart-line"></i>
        <h1>Gestion Pro</h1>
      </div>
      <span class="page-title" id="pageTitle">Tableau de bord</span>
    </div>
    <button class="theme-btn" onclick="toggleDark()">
      <i class="fas fa-moon"></i>
    </button>
  </div>

  <div class="main-content">
    <!-- Tableau de bord -->
    <div id="tab-dashboard" class="tab-content active">
      <div class="grid-3" style="margin-bottom: 20px;">
        <button onclick="showPerson('victor')" id="victor-toggle" class="btn active" style="background: var(--victor-color); opacity: 0.9;">
          <i class="fas fa-user"></i> Victor
        </button>
        <button onclick="showPerson('arthur')" id="arthur-toggle" class="btn" style="background: var(--arthur-color); opacity: 0.9;">
          <i class="fas fa-user"></i> Arthur
        </button>
        <button onclick="showBoth()" id="both-toggle" class="btn" style="background: var(--accent);">
          <i class="fas fa-users"></i> Les deux
        </button>
      </div>

      <div class="grid-2">
        <div class="card">
          <div class="card-title">
            <i class="fas fa-user"></i> Victor - Ajouter un gain
          </div>
          <form onsubmit="addGain(event, 'victor')">
            <div class="form-group">
              <input type="date" id="victor-date" required>
            </div>
            <div class="form-group">
              <input type="number" id="victor-amount" placeholder="Montant (€)" required min="0" step="0.01">
            </div>
            <div class="form-group">
              <input type="text" id="victor-description" placeholder="Description">
            </div>
            <button type="submit" class="btn btn-block" style="background: var(--victor-color);">
              <i class="fas fa-plus-circle"></i> Ajouter
            </button>
          </form>
          <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
            <div style="display: flex; justify-content: space-between;">
              <span style="font-weight: 600;">Total Victor:</span>
              <span style="font-weight: 700; color: var(--victor-color);" id="victor-total">0 €</span>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-title">
            <i class="fas fa-user"></i> Arthur - Ajouter un gain
          </div>
          <form onsubmit="addGain(event, 'arthur')">
            <div class="form-group">
              <input type="date" id="arthur-date" required>
            </div>
            <div class="form-group">
              <input type="number" id="arthur-amount" placeholder="Montant (€)" required min="0" step="0.01">
            </div>
            <div class="form-group">
              <input type="text" id="arthur-description" placeholder="Description">
            </div>
            <button type="submit" class="btn btn-block" style="background: var(--arthur-color);">
              <i class="fas fa-plus-circle"></i> Ajouter
            </button>
          </form>
          <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
            <div style="display: flex; justify-content: space-between;">
              <span style="font-weight: 600;">Total Arthur:</span>
              <span style="font-weight: 700; color: var(--arthur-color);" id="arthur-total">0 €</span>
            </div>
          </div>
        </div>
      </div>

      <div class="grid-4">
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-euro-sign"></i>
          </div>
          <div class="stat-number" id="total">0 €</div>
          <div class="stat-label">Total combiné</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-calendar-day"></i>
          </div>
          <div class="stat-number" id="yesterday">0 €</div>
          <div class="stat-label">Hier</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-calendar-week"></i>
          </div>
          <div class="stat-number" id="week">0 €</div>
          <div class="stat-label">Cette semaine</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">
            <i class="fas fa-calendar-alt"></i>
          </div>
          <div class="stat-number" id="month">0 €</div>
          <div class="stat-label">Ce mois</div>
        </div>
      </div>

      <div class="card">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <div class="card-title" style="margin-bottom: 0;">
            <i class="fas fa-chart-line"></i> Évolution des gains
          </div>
          <select id="period" onchange="drawChart()" style="width: auto; padding: 10px 16px;">
            <option value="today">Aujourd'hui</option>
            <option value="7">7 derniers jours</option>
            <option value="30">30 derniers jours</option>
            <option value="month">Ce mois</option>
            <option value="year">Cette année</option>
            <option value="all">Tout</option>
          </select>
        </div>
        <div style="position: relative; height: 300px;">
          <canvas id="chart"></canvas>
        </div>
      </div>

      <div class="card">
        <div class="card-title">
          <i class="fas fa-history"></i> Derniers gains
        </div>
        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Personne</th>
                <th>Description</th>
                <th>Montant</th>
              </tr>
            </thead>
            <tbody id="history-table-body"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Onglet Produits -->
    <div id="tab-products" class="tab-content">
      <div class="card">
        <div class="card-title">
          <i class="fas fa-box"></i> Ajouter un produit
        </div>
        <form onsubmit="addProduct(event)">
          <div class="grid-3">
            <input type="text" id="product-name" placeholder="Nom du produit" required>
            <input type="number" id="product-price" placeholder="Prix (€)" step="0.01" required>
            <input type="number" id="product-quantity" placeholder="Quantité" required>
            <select id="product-category">
              <option>Électronique</option>
              <option>Vêtements</option>
              <option>Alimentation</option>
              <option>Maison</option>
              <option>Autre</option>
            </select>
            <button type="submit" class="btn" style="background: var(--success);">
              <i class="fas fa-save"></i> Ajouter
            </button>
          </div>
        </form>
      </div>
      
      <div class="card">
        <div class="card-title">
          <i class="fas fa-boxes"></i> Catalogue produits
        </div>
        <div id="products-list" class="product-grid"></div>
      </div>
    </div>

    <!-- Onglet Stocks -->
    <div id="tab-inventory" class="tab-content">
      <div class="grid-4">
        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-box"></i></div>
          <div class="stat-number" id="total-products">0</div>
          <div class="stat-label">Produits</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-cubes"></i></div>
          <div class="stat-number" id="total-stock">0</div>
          <div class="stat-label">Unités en stock</div>
        </div>
        <div class="stat-card">
          <diElementById('victor-toggle').classList.remove('active');
  document.getElementById('arthur-toggle').classList.remove('active');
  document.getElementById('both-toggle').classList.remove('active');
  document.getElementById(`${person}-toggle`).classList.add('active');
  
  drawChart();
}

function showBoth() {
  currentView = 'both';
  
  // Mettre à jour les boutons
  document.getElementById('victor-toggle').classList.remove('active');
  document.getElementById('arthur-toggle').classList.remove('active');
  document.getElementById('both-toggle').classList.add('active');
  
  drawChart();
}

function openCharts() {
  document.getElementById("charts").scrollIntoView({ behavior: 'smooth' });
  drawChart();
}

function toggleDark() {
  document.body.classList.toggle("dark");
  // Mettre à jour les couleurs du graphique
  chart.data.datasets[0].borderColor = getComputedStyle(document.documentElement).getPropertyValue('--victor-color');
  chart.data.datasets[1].borderColor = getComputedStyle(document.documentElement).getPropertyValue('--arthur-color');
  chart.update();
}

// Initialisation
refresh();
drawChart();

// Remplir la date d'aujourd'hui par défaut
const today = new Date().toISOString().split('T')[0];
document.getElementById('victor-date').value = today;
document.getElementById('arthur-date').value = today;
</script>

</body>
          </html>
          
